file:
  - name: simple_variable_substitution
    sql: "SELECT * FROM {{ table_name }} WHERE id = {{ user_id }}"
    tokens:
      - type: Select
      - type: "*"
        value: "*"
      - type: From
      - type: TemplateVariable
        value: "{{ table_name }}"
      - type: Where
      - type: Identifier
        value: "id"
      - type: Operator
        value: "="
      - type: TemplateVariable
        value: "{{ user_id }}"

  - name: jinja_if_block
    sql: "SELECT * FROM users {% if active %}WHERE active = true{% endif %}"
    tokens:
      - type: Select
      - type: "*"
        value: "*"
      - type: From
      - type: Identifier
        value: "users"
      - type: JinjaIf
        value: "{% if active %}"
      - type: Where
      - type: Identifier
        value: "active"
      - type: Operator
        value: "="
      - type: Keyword
        value: "true"
      - type: JinjaEndif
        value: "{% endif %}"

  - name: jinja_for_loop
    sql: "SELECT {% for col in columns %}{{ col }}{% if not loop.last %}, {% endif %}{% endfor %} FROM table1"
    tokens:
      - type: Select
      - type: JinjaFor
        value: "{% for col in columns %}"
      - type: TemplateVariable
        value: "{{ col }}"
      - type: JinjaIf
        value: "{% if not loop.last %}"
      - type: Comma
        value: ","
      - type: JinjaEndif
        value: "{% endif %}"
      - type: JinjaEndfor
        value: "{% endfor %}"
      - type: From
      - type: Identifier
        value: "table1"

  - name: dbt_ref_function
    sql: "SELECT * FROM {{ ref('users') }} WHERE status = {{ var('active_status') }}"
    tokens:
      - type: Select
      - type: "*"
        value: "*"
      - type: From
      - type: TemplateVariable
        value: "{{ ref('users') }}"
      - type: Where
      - type: Identifier
        value: "status"
      - type: Operator
        value: "="
      - type: TemplateVariable
        value: "{{ var('active_status') }}"