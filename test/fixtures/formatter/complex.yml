file:
  - name: conditional_where_clause
    input: |
      SELECT id, name, email FROM users
      {% if filter_active %}
          WHERE active = TRUE
      {% endif %}
      ORDER BY created_at
    settings:
      indent:
        style: "spaces"
        size: 4
      line_width: 80
    expected: |
      SELECT
          id,
          name,
          email
      FROM users
      {% if filter_active %}
          WHERE active = TRUE
      {% endif %}
      ORDER BY created_at
  - name: conditional_join
    input: |
      SELECT u.id, u.name
      {% if include_profile %}
      , p.bio
      {% endif %}
      FROM users u
      {% if include_profile %}
      JOIN profiles p ON u.id = p.user_id
      {% endif %}
      WHERE u.active = TRUE
    settings:
      indent:
        style: "spaces"
        size: 4
      line_width: 80
    expected: |
      SELECT
          u.id,
          u.name
          {% if include_profile %}
              ,
              p.bio
          {% endif %}
      FROM users u
      {% if include_profile %}
          JOIN profiles p ON u.id = p.user_id
      {% endif %}
      WHERE u.active = TRUE

  - name: simple_conditional_field
    input: |
      SELECT id, name
      {% if show_email %}
      , email
      {% endif %}
      FROM users
    settings:
      indent:
        style: "spaces"
        size: 4
      line_width: 80
    expected: |
      SELECT
          id,
          name
          {% if show_email %}
              ,
              email
          {% endif %}
      FROM users
  - name: simple_conditional_field_2
    input: |
      SELECT id, name
      {% if show_email %}
      , email
      {% else %}
      , name
      {% endif %}
      FROM users -- hello
      LEFT JOIN {{ ref('my_table') }} USING(id)
    settings:
      indent:
        style: "spaces"
        size: 4
      line_width: 80
    expected: |
      SELECT
          id,
          name
          {% if show_email %}
              ,
              email
          {% else %}
              ,
              name
          {% endif %}
      FROM users
      LEFT JOIN {{ ref('my_table') }} USING(id)
